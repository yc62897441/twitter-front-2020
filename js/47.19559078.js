"use strict";(self["webpackChunktwitter_front_2020"]=self["webpackChunktwitter_front_2020"]||[]).push([[47],{5351:function(e,t,s){s.d(t,{Z:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy"}},e._l(e.replies,(function(s){return t("div",{key:"reply"+s.id,staticClass:"reply-wrapper"},[t("div",{staticClass:"reply-wrapper-left"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[t("img",{attrs:{src:s.User.avatar,alt:""}})])],1),t("div",{staticClass:"reply-wrapper-right"},[t("div",{staticClass:"reply-info"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[t("div",{staticClass:"reply-info-name"},[e._v(" "+e._s(s.User.name)+" ")])]),t("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[t("div",{staticClass:"reply-info-account"},[e._v("@"+e._s(s.User.account)+" ")])]),t("div",{staticClass:"reply-info-data"},[e._v("・"+e._s(e._f("fromNow")(s.createdAt)))])],1),t("div",{staticClass:"reply-to"},[e._v(" 回覆給 "),t("router-link",{staticClass:"link",attrs:{to:"/users/"+s.Tweet.User.id}},[t("p",[e._v("@"+e._s(s.Tweet.User.account))])])],1),t("router-link",{staticClass:"link",attrs:{to:"/tweets/"+s.Tweet.id}},[t("div",{staticClass:"reply-description"},[e._v(" "+e._s(s.comment)+" ")])])],1)])})),0)},i=[],a=s(3459),n={props:{replies:{type:Array},loadMoreTrigger:{type:String},loadToEnd:{type:Boolean}},methods:{loadMore(){"replies"===this.loadMoreTrigger&&!0!==this.loadToEnd&&(this.busy=!0,this.$emit("load-more",{from:"repliesSection"}),setTimeout((()=>{this.busy=!1}),1500))}},mixins:[a.q]},o=n,l=s(1001),c=(0,l.Z)(o,r,i,!1,null,null,null),d=c.exports},6632:function(e,t,s){s.d(t,{Z:function(){return p}});s(6699);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy"}},e._l(e.tweets,(function(r){return t("div",{key:r.id,staticClass:"tweet-wrapper"},[t("div",{staticClass:"tweet-wrapper-left"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.User.id}},[t("img",{attrs:{src:r.User.avatar,alt:""}})])],1),t("div",{staticClass:"tweet-wrapper-right"},[t("div",{staticClass:"tweet-info"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.User.id}},[t("div",{staticClass:"tweet-info-name"},[e._v(e._s(r.User.name))])]),t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.User.id}},[t("div",{staticClass:"tweet-info-account"},[e._v(" @"+e._s(r.User.account))])]),t("div",{staticClass:"tweet-info-data"},[e._v("・"+e._s(e._f("fromNow")(r.createdAt)))])],1),t("router-link",{staticClass:"link",attrs:{to:"/tweets/"+r.id}},[t("div",{staticClass:"tweet-description"},[e._v(" "+e._s(r.description)+" ")])]),t("div",{staticClass:"tweet-interaction"},[t("div",[t("img",{attrs:{src:s(3009),alt:"",type:"button","data-bs-toggle":"modal","data-bs-target":"#modal"+r.id}}),t("p",[e._v(e._s(r.repliesLength))])]),e.currentUser.userLikesId.includes(r.id)?t("div",[t("img",{attrs:{src:s(5179),type:"button",alt:""},on:{click:function(t){return e.unlikeTweet(r.id)}}}),t("p",[e._v(e._s(r.likesLength))])]):t("div",[t("img",{attrs:{src:s(5813),type:"button",alt:""},on:{click:function(t){return e.likeTweet(r.id)}}}),t("p",[e._v(e._s(r.likesLength))])])])],1),t("ModalTweetReply",{attrs:{tweet:r,currentUser:e.currentUser},on:{"after-post-tweet-reply":e.afterPostTweetReply}})],1)})),0)},i=[],a=s(3459),n=s(2090),o=s(3822),l=s(3729),c={components:{ModalTweetReply:n.Z},props:{propsTweets:{type:Array,required:!0},loadMoreTrigger:{type:String},loadToEnd:{type:Boolean}},data(){return{tweets:[],busy:!1}},methods:{afterPostTweetReply(e){const{TweetId:t}=e;this.tweets.forEach((e=>{e.id===Number(t)&&(e.repliesLength+=1)})),"user"===this.$router.history.current.name&&Number(this.$router.history.current.params.id)===this.currentUser.id&&this.$emit("after-post-tweet-reply",{...e})},async likeTweet(e){try{this.isProcessing=!0;let t=0;const{data:s}=await l.Z.likeTweet({tweetId:e});if("success"===s.status&&(this.currentUser.userLikesId.push(e),this.tweets.forEach((s=>{s.id===e&&(s.likesLength+=1,t=s.likesLength)}))),"user"===this.$route.name&&Number(this.$route.params.id)===this.currentUser.id){let s={};this.tweets.forEach((t=>{t.id===e&&(s={...t})})),this.$emit("after-like-tweet",{newLikedTweet:{...s},likesLength:t,from:"TweetsSection"})}this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},async unlikeTweet(e){try{this.isProcessing=!0;let t=0;const{data:s}=await l.Z.unlikeTweet({tweetId:e});"success"===s.status&&(this.currentUser.userLikesId=this.currentUser.userLikesId.map((t=>{if(t!==e)return t})),this.tweets.forEach((s=>{s.id===e&&(s.likesLength-=1,t=s.likesLength)}))),"user"===this.$route.name&&Number(this.$route.params.id)===this.currentUser.id&&this.$emit("after-unlike-tweet",{unlikeTweetId:e,likesLength:t,from:"TweetsSection"}),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},loadMore(){"tweets"===this.loadMoreTrigger&&!0!==this.loadToEnd&&(this.busy=!0,this.$emit("load-more",{from:"tweetsSection"}),setTimeout((()=>{this.busy=!1}),1500))}},computed:{...(0,o.rn)(["currentUser"])},watch:{propsTweets(e){this.tweets=e}},mixins:[a.q]},d=c,u=s(1001),h=(0,u.Z)(d,r,i,!1,null,null,null),p=h.exports},5821:function(e,t,s){s.r(t),s.d(t,{default:function(){return K}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"left-container"},[t("Navbar",{staticClass:"Navbar",attrs:{currentUser:e.currentUser}})],1),t("div",{staticClass:"middle-container"},[t("div",{staticClass:"middle-container-wrapper"},[t("div",{staticClass:"middle-container-arrow-wrapper"},[t("img",{attrs:{src:s(6995),type:"button",alt:""},on:{click:e.hasHistory}})]),t("div",{staticClass:"middle-container-page-title-wrapper"},[t("h1",[e._v(e._s(e.user.name))]),t("h3",[e._v(e._s(e.user.tweetsNum)+"則推文")])])]),t("UserBoard",{attrs:{propsUser:e.user,currentUser:e.currentUser},on:{"after-put-userInfo":e.afterPutUserInfo,"after-post-followship":e.afterPostFollowship,"after-delete-followship":e.afterDeleteFollowship}}),t("UserNavPills",{on:{"after-change-user-nav-pills":e.afterChangeUserNavPills}}),t("TweetsSection",{staticClass:"User-TweetsSection",attrs:{propsTweets:e.tweets,loadMoreTrigger:e.loadMoreTrigger,loadToEnd:e.loadToEndTweets},on:{"after-post-tweet-reply":e.afterPostTweetReply,"after-like-tweet":e.afterLikeTweet,"after-unlike-tweet":e.afterUnlikeTweet,"load-more":e.loadMore}}),t("RepliesSection",{staticClass:"User-RepliesSection User-Section-hidden",attrs:{replies:e.replies,loadMoreTrigger:e.loadMoreTrigger,loadToEnd:e.loadToEndReplies},on:{"load-more":e.loadMore}}),t("LikesSection",{staticClass:"User-LikesSection User-Section-hidden",attrs:{prosLikes:e.likes,loadMoreTrigger:e.loadMoreTrigger,loadToEnd:e.loadToEndLikes},on:{"after-post-tweet-reply":e.afterPostTweetReply,"after-like-tweet":e.afterLikeTweet,"after-unlike-tweet":e.afterUnlikeTweet,"load-more":e.loadMore}}),t("ModalNewTweet",{attrs:{currentUser:e.currentUser},on:{"after-post-new-tweet":e.afterPostNewTweet}})],1),t("div",{staticClass:"right-container"},[t("FollowingsBar",{staticClass:"FollowingsBar",attrs:{currentUser:e.currentUser},on:{"after-post-followship":e.afterPostFollowship,"after-delete-followship":e.afterDeleteFollowship}})],1)])},i=[],a=(s(1703),s(2474)),n=s(4904),o=(s(6699),function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-board-wrapper"},[t("div",{staticClass:"user-banner-wrapper"},[t("img",{attrs:{src:e.user.banner,alt:""}})]),t("div",{staticClass:"user-avatar-wrapper"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.user.id}},[t("img",{attrs:{src:e.user.avatar,alt:""}})])],1),e.user.id===e.currentUser.id?t("button",{staticClass:"btn btn-user-info",attrs:{type:"button","data-bs-toggle":"modal","data-bs-target":"#modalUserInfo"}},[e._v("編輯個人資料")]):t("div",{staticClass:"user-interaction-wrapper"},[e.currentUser.Followings.includes(e.user.id)?t("button",{staticClass:"user-interaction-wrapper-item btn btn-orange btn-isFollowed",attrs:{type:"button",disabled:e.isProcessing},on:{click:function(t){return e.deleteFollowship(e.user.id)}}},[e._v("正在跟隨")]):t("button",{staticClass:"user-interaction-wrapper-item btn btn-orange",attrs:{type:"button",disabled:e.isProcessing},on:{click:function(t){return e.postFollowship(e.user.id)}}},[e._v("跟隨")])]),t("div",{staticClass:"user-info-wrapper"},[t("div",{staticClass:"user-info-name"},[e._v(e._s(e.user.name))]),t("div",{staticClass:"user-info-account"},[e._v("@"+e._s(e.user.account))]),t("div",{staticClass:"user-info-introduction"},[e._v(e._s(e.user.introduction))]),t("div",{staticClass:"user-info-followship-wrapper"},[t("router-link",{staticClass:"link",attrs:{to:{name:"userFollowship",params:{id:e.user.id},query:{show:"userFollowings"}}}},[t("div",{staticClass:"user-info-followship-followings"},[e._v(e._s(e.propsUser.Followings?e.propsUser.Followings.length:0)+"個 "),t("p",[e._v("跟隨中")])])]),t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.user.id+"/followship"}},[t("div",{staticClass:"user-info-followship-followers"},[e._v(e._s(e.propsUser.Followers?e.propsUser.Followers.length:0)+"位"),t("p",[e._v(" 跟隨者")])])])],1)]),t("ModalUserInfo",{attrs:{propsUser:e.currentUser},on:{"after-put-userInfo":e.afterPutUserInfo}})],1)}),l=[],c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal fade",attrs:{id:"modalUserInfo",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"user-info-modal-header"},[t("div",{staticClass:"user-info-modal-header-left-wrapper"},[t("img",{attrs:{src:s(7092),alt:"",type:"button","data-bs-dismiss":"modal","aria-label":"Close"},on:{click:e.cancelEdit}}),t("div",[e._v("編輯個人檔案")])]),t("div",{staticClass:"user-info-modal-header-right-wrapper"},[t("button",{staticClass:"btn btn-user-info-modal",attrs:{type:"button",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleSubmit.apply(null,arguments)}}},[e._v("儲存")])])]),t("div",{staticClass:"user-info-modal-body"},[t("form",{staticClass:"user-info-form"},[t("div",{staticClass:"user-info-form-banner-wrapper"},[t("img",{attrs:{src:e.userNewInfo.banner,alt:"",type:"file",accept:"image/*"}}),t("div",[e._m(0),t("img",{staticClass:"user-info-icon",attrs:{type:"button",src:s(4797),alt:""},on:{click:e.removeBanner}})])]),t("div",{staticClass:"user-info-form-avatar-wrapper"},[t("img",{attrs:{src:e.userNewInfo.avatar,alt:""}}),e._m(1)]),t("div",{staticClass:"form-row mb-3 user-info-form-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.userNewInfo.name,expression:"userNewInfo.name"}],staticClass:"form-control",staticStyle:{"background-color":"#F5F8FA"},attrs:{type:"text",maxlength:"20",placeholder:"名稱",required:""},domProps:{value:e.userNewInfo.name},on:{keyup:e.words_deal,input:function(t){t.target.composing||e.$set(e.userNewInfo,"name",t.target.value)}}}),e._m(2)]),t("div",{staticClass:"form-row mb-3 user-info-form-row"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.userNewInfo.introduction,expression:"userNewInfo.introduction"}],attrs:{cols:"30",rows:"5",maxlength:"140",placeholder:"自我介紹"},domProps:{value:e.userNewInfo.introduction},on:{keyup:e.words_deal,input:function(t){t.target.composing||e.$set(e.userNewInfo,"introduction",t.target.value)}}}),e._m(3)])])])])]),t("input",{attrs:{id:"userNewBanner",type:"file",accept:"image/*",name:"userNewBanner"},on:{change:e.handleFileChange}}),t("input",{attrs:{id:"userNewAvatar",type:"file",accept:"image/*",name:"userNewAvatar"},on:{change:e.handleFileChange}})])},d=[function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"userNewBanner"}},[t("img",{staticClass:"user-info-icon",attrs:{type:"button",src:s(1229),alt:""}})])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"userNewAvatar"}},[t("img",{staticClass:"user-info-icon",attrs:{type:"button",src:s(1229),alt:""}})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"textContent-span-wrapper"},[t("span",{staticClass:"textContent-span textContent-span-warning textContent-span-hidden"},[e._v("字數已達上限!")]),t("span",{staticClass:"textContent-span textContent-span-hidden"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"textContent-span-wrapper"},[t("span",{staticClass:"textContent-span textContent-span-warning textContent-span-hidden"},[e._v("字數已達上限!")]),t("span",{staticClass:"textContent-span textContent-span-hidden"})])}],u=s(2103),h=s(6163),p=s(3822),w={props:{propsUser:{type:Object,required:!0}},data(){return{isProcessing:!1,userNewInfo:{},banner:"",avatar:"",userOriginalInfo:{}}},methods:{async handleSubmit(e){try{if(!this.userNewInfo.name)return h.F.fire({icon:"warning",title:"Name 不可為空白"}),void(this.userNewInfo.name=this.propsUser.name);this.userNewInfo.name.length>20&&(this.userNewInfo.name=this.userNewInfo.name.slice(0,20)),this.userNewInfo.introduction.length>140&&(this.userNewInfo.introduction=this.userNewInfo.introduction.slice(0,140));let e=new FormData;"object"===typeof this.banner?e.append("files",this.banner):"string"===typeof this.banner&&e.append("banner",this.banner),e.append("files",this.avatar),this.userNewInfo.name&&e.append("name",this.userNewInfo.name),this.userNewInfo.introduction&&e.append("introduction",this.userNewInfo.introduction);const t=this.currentUser.id;h.F.fire({icon:"warning",title:"正在更新中，請稍後",timer:!1});const s=await u.Z.putUser({userId:t,formData:e});if("success"!==s.data.status)throw new Error;h.F.fire({icon:"success",title:"更新成功"});const r={name:this.userNewInfo.name,introduction:this.userNewInfo.introduction};if(s.data.results){let e,t;s.data.results.forEach((s=>{"avatar"===s.originalname?(e=s.imgurLink,r.avatar=e):"banner"===s.originalname&&(t=s.imgurLink,r.banner=t)}))}"string"===typeof this.banner&&this.banner.length>0&&(r.banner=this.banner),this.$emit("after-put-userInfo",{...r}),this.$store.dispatch("afterPutUserInfo",{...r});const i=document.querySelectorAll(".textContent-span-wrapper");i.forEach((e=>{e.children[0].classList.add("textContent-span-hidden"),e.children[1].classList.add("textContent-span-hidden")})),this.avatar="",this.banner="",this.isProcessing=!1}catch(t){this.isProcessing=!1;let e="更新失敗，請稍後再試";t.response.data.message&&(e=t.response.data.message),h.F.fire({icon:"error",title:e})}},handleFileChange(e){const{files:t}=e.target,s=window.URL.createObjectURL(t[0]);"userNewAvatar"===e.target.name?(this.userNewInfo.avatar=s,this.avatar=new File([e.target.files[0]],"avatar")):"userNewBanner"===e.target.name&&(this.userNewInfo.banner=s,this.banner=new File([e.target.files[0]],"banner"))},removeBanner(){const e="https://i.imgur.com/wjSOQDI.png";this.banner=e,this.userNewInfo.banner=e},cancelEdit(){this.userNewInfo.name=this.userOriginalInfo.name,this.userNewInfo.introduction=this.userOriginalInfo.introduction,this.userNewInfo.banner=this.userOriginalInfo.banner,this.userNewInfo.avatar=this.userOriginalInfo.avatar},words_deal(e){const t=e.target.attributes.maxlength.value,s=e.target.value.length;t-s<=20?(e.target.parentElement.children[1].children[1].classList.remove("textContent-span-hidden"),e.target.parentElement.children[1].children[1].textContent=`${s}/${t}`,s>=t?e.target.parentElement.children[1].children[0].classList.remove("textContent-span-hidden"):e.target.parentElement.children[1].children[0].classList.add("textContent-span-hidden")):(e.target.parentElement.children[1].children[0].classList.add("textContent-span-hidden"),e.target.parentElement.children[1].children[1].classList.add("textContent-span-hidden"))}},computed:{...(0,p.rn)(["currentUser"])},watch:{propsUser(e){this.userNewInfo={...this.userNewInfo,...e},this.userOriginalInfo={...e}}},created(){this.userNewInfo={...this.userNewInfo,...this.propsUser},this.userOriginalInfo={...this.propsUser},this.banner=this.propsUser.banner}},f=w,m=s(1001),g=(0,m.Z)(f,c,d,!1,null,null,null),v=g.exports,k=s(2433),U={postNoti:({formData:e})=>h.l.post("/notify",e),deleteNoti:({notiObjId:e})=>h.l["delete"](`/notify/${e}`)},C={components:{ModalUserInfo:v},props:{propsUser:{type:Object,required:!0},currentUser:{type:Object,required:!0}},data(){return{user:{},followingsLength:"",followersLength:"",isProcessing:!1}},methods:{afterPutUserInfo(e){this.user={...this.user,...e},this.$emit("after-put-userInfo",{...e})},async postFollowship(e){try{this.isProcessing=!0;const t=this.currentUser.id,s={userId:t,id:e},{data:r}=await k.Z.postFollowship({formData:s});if("success"!==r.status)throw new Error(r.message);this.currentUser.Followings.push(e),Number(this.$route.params.id)===e&&"user"===this.$route.name&&this.$emit("after-post-followship",{situation:"atOtherUserPage",followerId:t}),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},async deleteFollowship(e){try{this.isProcessing=!0;const t=this.currentUser.id,{data:s}=await k.Z.deleteFollowship({followingId:e});if("success"!==s.status)throw new Error(s.message);this.currentUser.Followings=this.currentUser.Followings.map((t=>{if(t!==e)return t})),Number(this.$route.params.id)===e&&"user"===this.$route.name&&this.$emit("after-delete-followship",{situation:"atOtherUserPage",followerId:t}),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},async postNoti(e){try{this.isProcessing=!0;const t=this.currentUser.id,s={userId:t,id:e},{data:r}=await U.postNoti({formData:s});if("success"!==r.status)throw new Error(r.message);this.currentUser.NotiObjs.push(e),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},async deleteNoti(e){try{this.isProcessing=!0;this.currentUser.id;const{data:t}=await U.deleteNoti({notiObjId:e});if("success"!==t.status)throw new Error(t.message);this.currentUser.NotiObjs=this.currentUser.NotiObjs.map((t=>{if(t!==e)return t})),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},chat(e){this.$router.push({path:"/chat_private",userId:e,query:{userId:e}})}},watch:{propsUser(e){this.user={...this.user,...e},this.followingsLength=e.Followings.length,this.followersLength=e.Followers.length}}},b=C,y=(0,m.Z)(b,o,l,!1,null,null,null),A=y.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-nav-pills-wrapper"},[t("fieldset",[t("div",[t("input",{attrs:{type:"radio",id:"user-nav-pills-tweets",name:"user-nav-pills",value:"user-nav-pills-tweets",checked:""},on:{change:e.changeUserNavPills}}),t("label",{staticClass:"user-nav-pills-link",attrs:{for:"user-nav-pills-tweets"}},[e._v("推文")])]),t("div",[t("input",{attrs:{type:"radio",id:"user-nav-pills-tweetsAndReplies",name:"user-nav-pills",value:"user-nav-pills-tweetsAndReplies"},on:{change:e.changeUserNavPills}}),t("label",{staticClass:"user-nav-pills-link",attrs:{for:"user-nav-pills-tweetsAndReplies"}},[e._v("推文與回覆")])]),t("div",[t("input",{attrs:{type:"radio",id:"user-nav-pills-likes",name:"user-nav-pills",value:"user-nav-pills-likes"},on:{change:e.changeUserNavPills}}),t("label",{staticClass:"user-nav-pills-link",attrs:{for:"user-nav-pills-likes"}},[e._v("喜歡的內容")])])])])},I=[],_={methods:{changeUserNavPills(e){this.$emit("after-change-user-nav-pills",{value:e.target.value})}}},N=_,L=(0,m.Z)(N,T,I,!1,null,null,null),x=L.exports,E=s(6632),P=s(5351),S=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy"}},e._l(e.likes,(function(r){return t("div",{key:r.id,staticClass:"like-wrapper"},[t("div",{staticClass:"like-wrapper-left"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.Tweet.User.id}},[t("img",{attrs:{src:r.Tweet.User.avatar,alt:""}})])],1),t("div",{staticClass:"like-wrapper-right"},[t("div",{staticClass:"like-tweet-info"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.Tweet.User.id}},[t("div",{staticClass:"like-tweet-info-name"},[e._v(" "+e._s(r.Tweet.User.name))])]),t("router-link",{staticClass:"link",attrs:{to:"/users/"+r.Tweet.User.id}},[t("div",{staticClass:"like-tweet-info-account"},[e._v(" @"+e._s(r.Tweet.User.account))])]),t("div",{staticClass:"like-tweet-info-data"},[e._v("・"+e._s(e._f("fromNow")(r.Tweet.createdAt))+" ")])],1),t("router-link",{staticClass:"link",attrs:{to:"/tweets/"+r.Tweet.id}},[t("div",{staticClass:"like-tweet-description"},[e._v(" "+e._s(r.Tweet.description)+" ")])]),t("div",{staticClass:"like-interaction"},[t("div",[t("img",{attrs:{src:s(3009),alt:"",type:"button","data-bs-toggle":"modal","data-bs-target":"#modalTweetReplyLikesSection"+r.Tweet.id}}),t("p",[e._v(e._s(r.Tweet.repliesLength))])]),e.currentUser.userLikesId.includes(r.Tweet.id)?t("div",[t("img",{attrs:{src:s(5179),alt:"",type:"button"},on:{click:function(t){return e.unlikeTweet(r.Tweet.id)}}}),t("p",{staticClass:"like-interaction-liked-p"},[e._v(e._s(r.Tweet.likesLength))])]):t("div",[t("img",{attrs:{src:s(5813),alt:"",type:"button"},on:{click:function(t){return e.likeTweet(r.Tweet.id)}}}),t("p",[e._v(e._s(r.Tweet.likesLength))])])])],1),t("ModalTweetReplyLikesSection",{attrs:{tweet:r.Tweet,currentUser:e.currentUser},on:{"after-post-tweet-reply":e.afterPostTweetReply}})],1)})),0)},R=[],F=s(3729),B=s(2090),M=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal fade",attrs:{id:"modalTweetReplyLikesSection"+e.tweet.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[e._m(0),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"modal-tweet-wrapper"},[t("div",{staticClass:"modal-tweet-wrapper-left"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.tweet.User.id}},[t("img",{attrs:{src:e.tweet.User.avatar,alt:"",type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})]),t("span")],1),t("div",{staticClass:"modal-tweet-wrapper-right"},[t("div",{staticClass:"modal-tweet-info"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.tweet.User.id}},[t("div",{staticClass:"modal-tweet-info-name",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}},[e._v(" "+e._s(e.tweet.User.name))])]),t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.tweet.User.id}},[t("div",{staticClass:"modal-tweet-info-account",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}},[e._v(" @"+e._s(e.tweet.User.account)+" ")])]),t("div",{staticClass:"modal-tweet-info-data"},[e._v("・"+e._s(e._f("fromNow")(e.tweet.createdAt)))])],1),t("div",{staticClass:"modal-tweet-description"},[e._v(" "+e._s(e.tweet.description)+" ")]),t("div",{staticClass:"modal-reply-to"},[e._v(" 回覆給 "),t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.tweet.User.id}},[t("p",{attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}},[e._v("@"+e._s(e.tweet.User.account))])])],1)])]),t("div",{staticClass:"modal-tweet-reply-wrapper"},[t("div",{staticClass:"modal-tweet-reply-wrapper-left"},[t("router-link",{staticClass:"link",attrs:{to:"/users/"+e.currentUser.id}},[t("img",{attrs:{src:e.currentUser.avatar,alt:"",type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})])],1),t("form",{staticClass:"modal-tweet-reply-wrapper-right"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newTweetReply,expression:"newTweetReply"}],attrs:{tweetId:e.tweet.id,cols:"30",rows:"5",maxlength:"140",placeholder:"推你的回覆",name:"newTweetReply",required:""},domProps:{value:e.newTweetReply},on:{keyup:e.words_deal,input:function(t){t.target.composing||(e.newTweetReply=t.target.value)}}})])])]),t("div",{staticClass:"modal-footer"},[t("div",{staticClass:"textContent-span-wrapper",attrs:{id:"modalTweetReplyLikesSection-textContent-span-wrapper"+e.tweet.id}},[t("span",{staticClass:"textContent-span textContent-span-warning textContent-span-hidden"},[e._v("字數已達上限!")]),t("span",{staticClass:"textContent-span textContent-span-hidden"}),t("button",{staticClass:"btn btn-orange btn-new-tweet",attrs:{type:"button","data-bs-dismiss":"modal",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleSubmit(e.tweet.id,t)}}},[e._v("回覆")])])])])])])},O=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal-header"},[t("img",{attrs:{src:s(7092),alt:"",type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})])}],Z=s(3459),$={props:{tweet:{type:Object},currentUser:{type:Object,required:!0}},data(){return{newTweetReply:"",isProcessing:!1}},methods:{async handleSubmit(e,t){try{if(""===this.newTweetReply.trim())return void h.F.fire({icon:"warning",title:"回覆內容不可為空白"});this.newTweetReply.length>140&&(this.newTweetReply=this.newTweetReply.slice(0,140)),this.isProcessing=!0;const s={userId:this.currentUser.id,comment:this.newTweetReply},{data:r}=await F.Z.postTweetReply({formData:s,tweetId:e});this.$emit("after-post-tweet-reply",{...r,Tweet:{...this.tweet}}),this.newTweetReply="",t.target.parentElement.children[0].classList.add("textContent-span-hidden"),t.target.parentElement.children[1].classList.add("textContent-span-hidden"),this.isProcessing=!1}catch(s){this.isProcessing=!1,console.warn(s)}},words_deal(e){const t=e.target.attributes.maxlength.value,s=e.target.value.length,r=document.querySelector(`#modalTweetReplyLikesSection-textContent-span-wrapper${Number(e.target.attributes.tweetid.value)}`);t-s<=20?(r.children[1].classList.remove("textContent-span-hidden"),r.children[1].textContent=`${s}/${t}`,s>=t?r.children[0].classList.remove("textContent-span-hidden"):r.children[0].classList.add("textContent-span-hidden")):(r.children[0].classList.add("textContent-span-hidden"),r.children[1].classList.add("textContent-span-hidden"))}},mixins:[Z.q]},Q=$,D=(0,m.Z)(Q,M,O,!1,null,null,null),j=D.exports,Y={components:{ModalTweetReply:B.Z,ModalTweetReplyLikesSection:j},props:{prosLikes:{type:Array},loadMoreTrigger:{type:String},loadToEnd:{type:Boolean}},data(){return{likes:[],isProcessing:!1}},methods:{async likeTweet(e){try{this.isProcessing=!0;let t=0;const{data:s}=await F.Z.likeTweet({tweetId:e});"success"===s.status&&(this.currentUser.userLikesId.push(e),this.likes.forEach((s=>{s.Tweet.id===e&&(s.Tweet.likesLength+=1,t=s.Tweet.likesLength)}))),"user"===this.$route.name&&Number(this.$route.params.id)===this.currentUser.id&&this.$emit("after-like-tweet",{likeTweetId:e,likesLength:t,from:"LikesSection"}),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},async unlikeTweet(e){try{this.isProcessing=!0;let t=0;const{data:s}=await F.Z.unlikeTweet({tweetId:e});"success"===s.status&&(this.currentUser.userLikesId=this.currentUser.userLikesId.map((t=>{if(t!==e)return t})),this.likes.forEach((s=>{s.Tweet.id===e&&(s.Tweet.likesLength-=1,t=s.Tweet.likesLength)}))),"user"===this.$route.name&&Number(this.$route.params.id)===this.currentUser.id&&this.$emit("after-unlike-tweet",{unlikeTweetId:e,likesLength:t,from:"LikesSection"}),this.isProcessing=!1}catch(t){this.isProcessing=!1,console.warn(t)}},afterPostTweetReply(e){const{TweetId:t}=e;this.likes.forEach((e=>{e.Tweet.id===Number(t)&&(e.Tweet.repliesLength+=1)})),"user"===this.$router.history.current.name&&Number(this.$router.history.current.params.id)===this.currentUser.id&&this.$emit("after-post-tweet-reply",{...e})},loadMore(){"likes"===this.loadMoreTrigger&&!0!==this.loadToEnd&&(this.busy=!0,this.$emit("load-more",{from:"likesSection"}),setTimeout((()=>{this.busy=!1}),1500))}},computed:{...(0,p.rn)(["currentUser"])},watch:{prosLikes(e){this.likes=e}},mixins:[Z.q]},W=Y,q=(0,m.Z)(W,S,R,!1,null,null,null),J=q.exports,G=s(430),V={components:{Navbar:a.Z,FollowingsBar:n.Z,UserBoard:A,UserNavPills:x,TweetsSection:E.Z,RepliesSection:P.Z,LikesSection:J,ModalNewTweet:G.Z},data(){return{user:{},tweets:[],replies:[],likes:[],tweetsOffset:0,repliesOffset:0,likesOffset:0,loadMoreTrigger:"tweets",loadToEndTweets:!1,loadToEndReplies:!1,loadToEndLikes:!1}},methods:{async fetchUser(e){try{const t=await u.Z.getUser({userId:e});if(200!==t.status)throw new Error;const s=t.data;this.user={...s}}catch(t){console.warn(t),h.F.fire({icon:"error",title:"找不到該位 User",timer:2e3}),this.$router.push({name:"not-found"}),setTimeout((()=>{this.$router.go(-2)}),1e3)}},async fetchUserTweets(e){try{const t=this.tweetsOffset||0;this.tweetsOffset=this.tweetsOffset+10;const s=await u.Z.getUserTweets({userId:e,tweetsOffset:t}),r=s.data;if("loadToEnd"===r)return void(this.loadToEndTweets=!0);r.forEach((e=>{this.tweets.push(e)}))}catch(t){console.warn(t)}},async fetchReplies(e){try{const t=this.repliesOffset||0;this.repliesOffset=this.repliesOffset+10;const{data:s}=await u.Z.getUserRepliedTweets({userId:e,repliesOffset:t});if("loadToEnd"===s)return void(this.loadToEndReplies=!0);s.forEach((e=>{this.replies.push(e)}))}catch(t){console.warn(t)}},async fetchLikes(e){try{const t=this.likesOffset||0;this.likesOffset=this.likesOffset+10;const{data:s}=await u.Z.getUserLikes({userId:e,likesOffset:t});if("loadToEnd"===s)return void(this.loadToEndLikes=!0);s.forEach((e=>{this.likes.push(e)}))}catch(t){console.warn(t)}},afterChangeUserNavPills(e){const t=e.value,s=document.querySelector(".User-TweetsSection"),r=document.querySelector(".User-RepliesSection"),i=document.querySelector(".User-LikesSection");switch(t){case"user-nav-pills-tweets":s.classList.remove("User-Section-hidden"),r.classList.add("User-Section-hidden"),i.classList.add("User-Section-hidden"),this.loadMoreTrigger="tweets";break;case"user-nav-pills-tweetsAndReplies":s.classList.add("User-Section-hidden"),r.classList.remove("User-Section-hidden"),i.classList.add("User-Section-hidden"),this.loadMoreTrigger="replies";break;case"user-nav-pills-likes":s.classList.add("User-Section-hidden"),r.classList.add("User-Section-hidden"),i.classList.remove("User-Section-hidden"),this.loadMoreTrigger="likes";break}},afterPostNewTweet(e){this.tweets.unshift({Likes:[],Replies:[],User:{account:this.currentUser.account,avatar:this.currentUser.avatar,banner:this.currentUser.banner,id:this.currentUser.id,introduction:this.currentUser.introduction,name:this.currentUser.name,role:this.currentUser.role},UserId:this.currentUser.id,createdAt:Date.now(),description:e.description,id:e.tweetId,likesLength:0,repliesLength:0,updatedAt:Date.now()}),h.F.fire({icon:"success",title:"推文發送成功"})},afterPostTweetReply(e){this.replies.unshift({User:{id:this.currentUser.id,avatar:this.currentUser.avatar,account:this.currentUser.account,name:this.currentUser.name},Tweet:{...e.Tweet},id:e.id,comment:e.comment,createdAt:e.createdAt}),h.F.fire({icon:"success",title:"回覆發送成功"})},afterPutUserInfo(e){this.tweets.forEach((t=>{t.User.name=e.name,t.User.avatar=e.avatar?e.avatar:this.currentUser.avatar})),this.replies.forEach((t=>{t.User.name=e.name,t.User.avatar=e.avatar?e.avatar:this.currentUser.avatar})),this.likes.forEach((t=>{t.Tweet.User.id===this.currentUser.id&&(t.Tweet.User.name=e.name,t.Tweet.User.avatar=e.avatar?e.avatar:this.currentUser.avatar)})),this.user.name=e.name},hasHistory(){this.$router.go(-1)},afterPostFollowship(e){"atCurrentUserPage"===e.situation?this.user.Followings.push(Number(e.followingId)):"atOtherUserPage"===e.situation&&this.user.Followers.push(Number(e.followerId))},afterDeleteFollowship(e){if("atCurrentUserPage"===e.situation){const t=[];this.user.Followings.forEach((s=>{s!==e.followingId&&t.push(s)})),this.user.Followings=t}else if("atOtherUserPage"===e.situation){const t=[];this.user.Followers.forEach((s=>{s!==e.followerId&&t.push(s)})),this.user.Followers=t}},afterLikeTweet(e){if("TweetsSection"===e.from){const t=e.likesLength;let s=!1;this.likes.forEach((r=>{r.Tweet.id===e.newLikedTweet.id&&(s=!0,r.Tweet.likesLength=t)})),s||this.likes.unshift({Tweet:{...e.newLikedTweet}})}if("LikesSection"===e.from){const t=e.likesLength,s=e.likeTweetId;this.tweets.forEach((e=>{e.id===s&&(e.likesLength=t)}))}},afterUnlikeTweet(e){const t=e.unlikeTweetId,s=e.likesLength,r=[];"TweetsSection"===e.from&&(this.likes.forEach((e=>{e.Tweet.id!==t&&r.push(e)})),this.likes=r),this.tweets.forEach((e=>{e.id===t&&(e.likesLength=s)}))},loadMore(e){const t=this.$route.params.id;switch(e.from){case"tweetsSection":this.fetchUserTweets(t);break;case"repliesSection":this.fetchReplies(t);break;case"likesSection":this.fetchLikes(t);break}}},computed:{...(0,p.rn)(["currentUser"])},mounted(){const e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweets(e),this.fetchReplies(e),this.fetchLikes(e)},beforeRouteUpdate(e,t,s){const r=e.params.id;this.fetchUser(r),this.fetchUserTweets(r),this.fetchReplies(r),this.fetchLikes(r),s()}},H=V,X=(0,m.Z)(H,r,i,!1,null,null,null),K=X.exports},6995:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAcCAYAAAAEN20fAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB6SURBVHgB7ZfBCYAwDEW/TuAIbtZsnhHaDTSBCir1oEJy+Q9e6fFBCqHAe8SsppoFSYi5naxIQG4RriIYGUS4oaMRRjCCEYz4GBGlmmXqlxW5tNmOBfk0PwS5o/ENXo6ip5jQx8oYxjCGMZkxKf+aUYwiEekBlx3xlx0JyMM9ap/GrgAAAABJRU5ErkJggg=="},4797:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC1SURBVHgB1ZdtCsMgEESXXrS5eY/gEV4t1CJNk9W4y9CB/WPCvBD3Q82UArYapcajxt2S1HPawgvYKxz+hn7UFgt7hcG/oT1447eW4Ufe7gsr8GHPSPi0VwT8sscKfPnDrxgQtVUzRkQn54ghWeV4ZkxiD/DgedBJeM6QceDD0Jv9gyS/GkVyoSgnFA0ERctEMSRQjEUUBwECk2TYi4SycD3JqkVzjrfsbxIh0DN4e1CyoEfwJ+MwNWnJ3xqoAAAAAElFTkSuQmCC"},1229:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJnSURBVHgB7ZnhUeswDMcV7n1/701ANqBMQJmAbkA3oBs0G5QNXCboCG0noBskG8AGQjqrxLhOItsp9AO/O4Hjs61/ZMV20gIyQMQp/WO7IyvFmHeyg9hLURQH+E5YGNkW9bySPcK5ISf/yNaYjuEx4BzQwCVZ7Tl8I1uRPZBdO20nUmcCInmMEsZEIueLW2miITdmAiLHi2TAQXQ+UZ+FN8YmdgBO/I3cnW8uT5AI9Z0HIukaP0zbkwBQxTPqWEEmaFND7ytwV13UOEJyYzifu1gU9OeV+k2k/7OYz3+yhhbcdxgBtA/I3w4/C7LjFO/AlQsXgET4k8IVRhEq4AJwNf2BTGS6ZmQ3ZMe1jVNhT7bLTovUKZapqNDuJn2Y2Ifri6YUgWi3shr11DEiswSKuKGoheA+E6WPNIEYPjC4GAwfEI7UqNu/kwWaHudG2W6p8PPJFShBm0PzniZNR9lngREnGbVAsEf7MWBxD9rGMevgTaBuDW209k49lyspl3Aa+SnZC2jQ5iCevoMYUBLIyc1A+/gcBLs7jIU6B2Om2Bc4l6A3cr2nbW3HBbSvo3dSX8LpFOtfQyOm+An7WTptlwNtHwd8JU2xLql17LUN1QLlVLLuaVJ2lH3WNFYDWrRTLG15q+vbhw0Ob3Wlwk+rKUagdJ5iOjOlj3SBMsAM445bb1pxowiUQUJfDEJsMePAmv1OIs55b51CuwA30H56i17gv2jKFXgOXE0x6+CP8CswFxbYHC9o6iv4YTwNB35IeJOv4DKpWCAvDVtoPyBdCgdaVG6veJ3iAtgofu/PBWEasFru+eIDDxAkea8CGmMAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=47.19559078.js.map