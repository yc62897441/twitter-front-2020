"use strict";(self["webpackChunktwitter_front_2020"]=self["webpackChunktwitter_front_2020"]||[]).push([[108],{5351:function(t,e,s){s.d(e,{Z:function(){return d}});var r=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"busy"}},t._l(t.replies,(function(s){return e("div",{key:"reply"+s.id,staticClass:"reply-wrapper"},[e("div",{staticClass:"reply-wrapper-left"},[e("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[e("img",{attrs:{src:s.User.avatar,alt:""}})])],1),e("div",{staticClass:"reply-wrapper-right"},[e("div",{staticClass:"reply-info"},[e("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[e("div",{staticClass:"reply-info-name"},[t._v(" "+t._s(s.User.name)+" ")])]),e("router-link",{staticClass:"link",attrs:{to:"/users/"+s.User.id}},[e("div",{staticClass:"reply-info-account"},[t._v("@"+t._s(s.User.account)+" ")])]),e("div",{staticClass:"reply-info-data"},[t._v("・"+t._s(t._f("fromNow")(s.createdAt)))])],1),e("div",{staticClass:"reply-to"},[t._v(" 回覆給 "),e("router-link",{staticClass:"link",attrs:{to:"/users/"+s.Tweet.User.id}},[e("p",[t._v("@"+t._s(s.Tweet.User.account))])])],1),e("router-link",{staticClass:"link",attrs:{to:"/tweets/"+s.Tweet.id}},[e("div",{staticClass:"reply-description"},[t._v(" "+t._s(s.comment)+" ")])])],1)])})),0)},i=[],a=s(3459),n={props:{replies:{type:Array},loadMoreTrigger:{type:String},loadToEnd:{type:Boolean}},methods:{loadMore(){"replies"===this.loadMoreTrigger&&!0!==this.loadToEnd&&(this.busy=!0,this.$emit("load-more",{from:"repliesSection"}),setTimeout((()=>{this.busy=!1}),1500))}},mixins:[a.q]},o=n,c=s(1001),l=(0,c.Z)(o,r,i,!1,null,null,null),d=l.exports},3592:function(t,e,s){s.r(e),s.d(e,{default:function(){return _}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"left-container"},[e("Navbar",{staticClass:"Navbar",attrs:{currentUser:t.currentUser}})],1),e("div",{staticClass:"middle-container"},[e("div",{staticClass:"middle-container-wrapper"},[e("div",{staticClass:"middle-container-arrow-wrapper"},[e("img",{attrs:{src:s(6995),type:"button",alt:""},on:{click:t.hasHistory}})]),t._m(0)]),e("TweetSection",{attrs:{propsTweet:t.tweet},on:{"after-post-tweet-reply":t.afterPostTweetReply}}),e("RepliesSection",{attrs:{replies:t.replies}}),e("ModalNewTweet",{attrs:{currentUser:t.currentUser}})],1),e("div",{staticClass:"right-container"},[e("FollowingsBar",{staticClass:"FollowingsBar",attrs:{currentUser:t.currentUser}})],1)])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"middle-container-page-title-wrapper"},[e("h1",[t._v("推文")])])}],a=(s(1703),s(2474)),n=s(4904),o=(s(6699),function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"tweet-wrapper"}},[e("div",{staticClass:"tweet-user-info-layer"},[e("div",[e("router-link",{staticClass:"link",attrs:{to:"/users/"+t.tweet.User.id}},[e("img",{attrs:{src:t.tweet.User.avatar,alt:""}})])],1),e("div",{staticClass:"tweet-user-info-wrapper"},[e("router-link",{staticClass:"link",attrs:{to:"/users/"+t.tweet.User.id}},[e("div",{staticClass:"tweet-user-info-name"},[t._v(t._s(t.tweet.User.name))])]),e("router-link",{staticClass:"link",attrs:{to:"/users/"+t.tweet.User.id}},[e("div",{staticClass:"tweet-user-info-account"},[t._v("@"+t._s(t.tweet.User.account))])])],1)]),e("div",{staticClass:"tweet-description-layer"},[t._v(" "+t._s(t.tweet.description)+" ")]),e("div",{staticClass:"tweet-date-layer"},[t._v(" "+t._s(t._f("formatTime")(t.tweet.createdAt))+" ")]),e("div",{staticClass:"tweet-interaction-layer"},[e("div",[t._v(t._s(t.tweet.repliesLength)),e("p",[t._v("回覆")])]),e("div",[t._v(t._s(t.tweet.likesLength)),e("p",[t._v("喜歡次數")])])]),e("div",{staticClass:"tweet-interaction-icons-layer"},[e("img",{attrs:{src:s(3009),alt:"",type:"button","data-bs-toggle":"modal","data-bs-target":"#modal"+t.tweet.id}}),t.currentUser.userLikesId.includes(t.tweet.id)?e("img",{attrs:{src:s(5179),type:"button",alt:""},on:{click:function(e){return t.unlikeTweet(t.tweet.id)}}}):e("img",{attrs:{src:s(5813),type:"button",alt:""},on:{click:function(e){return t.likeTweet(t.tweet.id)}}})]),e("ModalTweetReply",{attrs:{tweet:t.tweet,currentUser:t.currentUser},on:{"after-post-tweet-reply":t.afterPostTweetReply}})],1)}),c=[],l=s(2090),d=s(3729),u=s(3459),w=s(3822),p={components:{ModalTweetReply:l.Z},props:{propsTweet:{type:Object,required:!0}},data(){return{tweet:{},newTweetReply:"",isProcessing:!1}},methods:{async handleSubmit(t){try{if(""===this.newTweetReply)return;this.isProcessing=!0;const e={userId:this.currentUser.id,comment:this.newTweetReply},{data:s}=await d.Z.postTweetReply({formData:e,tweetId:t});this.$emit("after-post-tweet-reply",{...s}),this.newTweetReply="",this.isProcessing=!1}catch(e){this.isProcessing=!1,console.warn(e)}},afterPostTweetReply(t){const{TweetId:e}=t;this.tweet.repliesLength+=1,this.$emit("after-post-tweet-reply",{...t})},async likeTweet(t){try{this.isProcessing=!0;this.currentUserId;const{data:e}=await d.Z.likeTweet({tweetId:t});"success"===e.status&&(this.currentUser.userLikesId.push(t),this.tweet.likesLength+=1),this.isProcessing=!1}catch(e){this.isProcessing=!1,console.warn(e)}},async unlikeTweet(t){try{this.isProcessing=!0;this.currentUserId;const{data:e}=await d.Z.unlikeTweet({tweetId:t});"success"===e.status&&(this.currentUser.userLikesId=this.currentUser.userLikesId.map((e=>{if(e!==t)return e})),this.tweet.likesLength-=1),this.isProcessing=!1}catch(e){this.isProcessing=!1,console.warn(e)}}},computed:{...(0,w.rn)(["currentUser"])},watch:{propsTweet(t){this.tweet={...t}}},mixins:[u.q]},h=p,f=s(1001),v=(0,f.Z)(h,o,c,!1,null,null,null),m=v.exports,y=s(5351),A=s(430),g=s(6163),T={components:{Navbar:a.Z,FollowingsBar:n.Z,TweetSection:m,RepliesSection:y.Z,ModalNewTweet:A.Z},data(){return{tweet:{},isProcessing:!1,replies:[]}},methods:{async fetchTweet(t){try{const e=t,s=await d.Z.getTweet({id:e});if(200!==s.status)throw new Error;const r=s.data;this.tweet=r}catch(e){console.warn(e),g.F.fire({icon:"error",title:"找不到該則 Tweet",timer:2e3}),this.$router.push({name:"not-found"}),setTimeout((()=>{this.$router.go(-2)}),1e3)}},async getTweetReplies(t){try{const{data:e}=await d.Z.getTweetReplies({tweetId:t});this.replies=e}catch(e){console.warn(e)}},afterPostTweetReply(t){this.replies.unshift({TweetId:t.TweetId,UserId:t.UserId,comment:t.comment,createdAt:t.createdAt,id:t.id,updatedAt:t.updatedAt,User:{id:this.currentUser.id,name:this.currentUser.name,account:this.currentUser.account,avatar:this.currentUser.avatar},Tweet:{User:{account:this.tweet.User.account}}})},hasHistory(){this.$router.go(-1)}},computed:{...(0,w.rn)(["currentUser"])},mounted(){const t=this.$route.params.id;this.fetchTweet(t),this.getTweetReplies(t)},beforeRouteUpdate(t,e,s){const r=t.params.id;this.fetchTweet(r),this.getTweetReplies(r),s()}},U=T,C=(0,f.Z)(U,r,i,!1,null,null,null),_=C.exports},6995:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAcCAYAAAAEN20fAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB6SURBVHgB7ZfBCYAwDEW/TuAIbtZsnhHaDTSBCir1oEJy+Q9e6fFBCqHAe8SsppoFSYi5naxIQG4RriIYGUS4oaMRRjCCEYz4GBGlmmXqlxW5tNmOBfk0PwS5o/ENXo6ip5jQx8oYxjCGMZkxKf+aUYwiEekBlx3xlx0JyMM9ap/GrgAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=108.4cf24e19.js.map